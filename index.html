<!DOCTYPE html>
<html>

<head>
	<title>Rock, Paper, Splat!</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="res/css/style.css">
	<link href="https://fonts.googleapis.com/css?family=Open+Sans|Quicksand" rel="stylesheet">
</head>

<body>
	<div>
		<div class="titleBanner">
			<div class="titleLogo">
				<h1 class="titleName">RockPaperSplat</h1>
				<img class="titleIcon" src="res/img/logo.png">
			</div>
		</div>
		<div class="content">
			<div>
				<div>
					<h2>About the Game</h2>
				</div>
				<div>
					<p>
						RockPaperSplat! is a fun-filled action adventure game full of surprises and microtransactions.
					</p>
				</div>
			</div>
			<div>
				<div>
					<h2>Controls</h2>
				</div>
				<div>
					<h3>Keyboard</h3>
					<p>
						Use the <kbd>W, A, S, D</kbd> keys to move
					</p>
				</div>
				<div>
					<h3>Controller</h3>
					<p>
						Use the <kbd>Left control stick</kbd> to move
					</p>
				</div>
			</div>
			<div>
				<div>
					<h2>Mechanics</h2>
				</div>
				<div>
					<p>
						These are the mechanics
					</p>
				</div>
			</div>
		</div>
		<div class="spriteEditor">
			<div class="content">
				<div>
					<h2>Sprite Editor</h2>
				</div>
				<div class="canvasEditor">
					<canvas id="canvas" class="canvas" width="640" height="640"></canvas>
					<canvas id="canvasGrid" class="canvasGrid" width="640" height="640"></canvas>
				</div>
				<div class="canvasMisc">
					<div class="colorPicker">
						<input type="color" id="colorPicker" value="#000000">
					</div>
					<div class="buttonSave">
						<button class="saveButton" onclick="saveCanvas()">SAVE</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		var can = document.getElementById('canvas'),
		boxes = 64,
		size = 10,
		ctx = can.getContext('2d');

		/*can.addEventListener('mousemove', function(evt) {
			var mousePos = getMousePos(can, evt);
			var sx = (Math.ceil(mousePos.x/size)-1)*size,
			sy =  (Math.ceil(mousePos.y/size)-1)*size;
		}, false);*/

		can.addEventListener('mousedown', function(evt) {
			can.addEventListener('mousemove', function(evt) {
				var customColor = document.getElementById('colorPicker');
				var mousePos = getMousePos(can, evt);
				var sx = (Math.ceil(mousePos.x/size)-1)*size,
				sy =  (Math.ceil(mousePos.y/size)-1)*size;
				ctx.fillStyle = customColor.value;
				ctx.fillRect(sx,sy,size,size);
			}, false);
		});

		// can.addEventListener('mouseup', function(evt {}, true);

		function getMousePos(canvas, evt) {
			var rect = can.getBoundingClientRect();
			return {
				x: evt.clientX - rect.left,
				y: evt.clientY - rect.top
			};
		}

		function saveCanvas() {
			var canvas = document.getElementById("canvas");
			var img = canvas.toDataURL();
			console.log(img);
		}
	</script>
	<script type="text/javascript">
		var canvas = document.getElementById('canvasGrid'),
		boxes = 64,
		size = 10,
		context = canvas.getContext('2d');

		function drawGrid() {
			var len = canvas.height = canvas.width = boxes * size;
			for (var i = 0; i < boxes; i++) {
				context.beginPath();
				context.strokeStyle = "#000";
				context.moveTo(size + size * i - .5, 0);
				context.lineTo(size + size * i - .5, len);
				context.moveTo(0, size + size * i - .5);
				context.lineTo(len, size + size * i - .5);
				context.stroke();
			}
		}

		drawGrid();
	</script>
</body>

</html>